---
title: "Entrega 1"
author: "Grupo X"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    html_document:
        keep_md: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Librerias

```{r}
library(tidyverse)
library(kableExtra)
```

## Datos

```{r}
datos <- read_csv2("../data/raw/DAMASCO.csv")
```

Inspeccionamos con `str(datos)`

```{r}
str(datos)
```


A. Cuáles son los valores de n y p ? Cuanto vale y que indica el valor $x_{32}$ ? Y el vector $x_6$ ?


El valor de $n$ es `r nrow(datos)` y el valor de $p$ es `r ncol(datos)`. El
valor de $x_{32}$ es `r datos[[3, 2]]` e indica el tamano de la flor de la 
observacion 3. El vector $x_6$ indica la relacion entre el ancho y largo de la 
hoja.

B. Cómo clasificaría las variables sobre las que se está trabajando ?


Las variables con las que se esta trabajando son de tipo continuo en todos los 
casos. Mas aun, todas estan medidas en escala de intervalo.


C. Encuentre el vector de medias y matriz de varianzas-covariancias asociados a la tabla de datos ?

Las medias son:

```{r}
datos %>% 
    select(-VAR) %>% 
    summarise_all(mean, na.rm=T) %>% 
    round(1) %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 10) %>% 
    kableExtra::kable_classic_2()

```

La matriz de covarianza es:

```{r,out.width=.5}
datos %>% 
    select(-VAR) %>%  
    cov() %>%  
    round(1) %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 10)%>% 
    kableExtra::kable_classic_2() 
```

D. Podría decir cuál y cuáles variables son las más dispersas ?

Utilizando el coeficiente de variación, podemos decir que las variables más dispersas, en orden decreciente, son:

```{r}

datos %>% select(-VAR) %>%
    summarise_all(function(x) sd(x, na.rm=TRUE) /  mean(x, na.rm=TRUE)) %>% 
    as_vector() %>% 
    sort() %>% 
    rev() %>% 
    names() %>%
    as_tibble() %>% 
    mutate(orden = seq(ncol(datos)-1) ) %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 10)%>% 
    kableExtra::kable_classic_2()
```

E. Estandarice las variables por media y desvío. Ahora puede responder al inciso (d) ?

Aca hay que calcular el coeficiente de variacion.

```{r}
# No utilizamos la primer columna
datos_std = scale(datos[-1])
```

Como son variables estandarizadas, el coeficiente de variacion no existe,
pero todas tienen desvio estandar 1.

```{r}
datos_std %>%
    as_tibble() %>% 
    summarise_all(function(x) sd(x, na.rm=TRUE) /  mean(x, na.rm=TRUE)) %>% 
    round(1)
```

F. Halle la matriz de correlación. Que variables son las más relacionadas?

La matriz de correlación es:

```{r}
datos %>% 
    select(-VAR) %>%
    cor() %>% 
    round(1)  %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 10)%>% 
    kableExtra::kable_classic_2()
```

A continuacion una tabla con las 10 correlaciones más grandes entre variables, ordenadas de mayor a menor magnitud.

```{r}
ncol_datos = ncol(datos)-1
datos %>% 
    select(-VAR) %>%
    cor() %>% 
    as_tibble() %>% 
    mutate(var0=colnames(.)) %>% 
    pivot_longer(
        "TAMFLOR":"ANCHOEND", 
        names_to="var1", values_to="corr"
    ) %>% 
    filter(
        rep(
            1:ncol_datos,
            each=ncol_datos
        ) > 
            rep(
                1:ncol_datos,
                times=ncol_datos
            )
    ) %>% 
    arrange(-abs(corr)) %>% 
    head(10) %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 10)%>% 
    kableExtra::kable_classic_2()
```


G. Pueden dividirse las variables en subgrupos, de modo que las variables dentro de un mismo subgrupo tengan elevadas correlaciones entre sí y que las que se encuentren en subgrupos diferentes tengan bajas correlaciones ? Si es así, cuáles variables quedan en cada uno de los subgrupos ?


H. Encuentre la matriz que mide el grado de similaridad entre las variedades en función de la distancia euclídea calculada sobre los datos originales.

```{r}
aux = datos %>% 
    select(-VAR) %>% 
    data.frame()

rownames(aux) <- datos$VAR

aux %>% 
    dist(diag = T, upper=T) %>% 
    as.matrix() %>% 
    round(1)  %>% 
    kableExtra::kable() %>% 
    kableExtra::kable_styling(font_size = 8)%>% 
    kableExtra::kable_classic_2()

```

I. Podría decir cuales son los tres pares de variedades que presentan mayor semejanza ?


J. Repita lo realizado en el inciso (h) pero sobre las variables estandarizadas por media y desvío estándar.
Son las mimas las tres variedades más parecidas ? Comente al respecto