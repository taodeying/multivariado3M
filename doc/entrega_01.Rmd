---
title: "Entrega 1"
author: "Grupo X"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

## Librerias

```{r}
library(tidyverse)
```

## Datos

```{r}
datos <- read_csv2("../data/raw/DAMASCO.csv")
```

Inspeccionamos con `str(datos)`

```{r}
str(datos)
```

A. Cuáles son los valores de n y p ? Cuanto vale y que indica el valor $x_{32}$ ?
Y el vector $x_6$ ?

El valor de $n$ es `r nrow(datos)` y el valor de $p$ es `r ncol(datos)`. El
valor de $x_{32}$ es `r datos[[3, 2]]` e indica el tamano de la flor de la 
observacion 3. El vector $x_6$ indica la relacion entre el ancho y largo de la 
hoja.

B. Cómo clasificaría las variables sobre las que se está trabajando ?

Las variables con las que se esta trabajando son de tipo continuo en todos los 
casos. Mas aun, todas estan medidas en escala de intervalo.

C. Encuentre el vector de medias y matriz de varianzas-covariancias asociados a la tabla de datos ?

```{r}
datos %>% 
    select(-VAR) %>% 
    summarise_all(mean, na.rm = TRUE)
```

```{r}
datos %>% select(-VAR) %>%  cov() %>%  round(1)
# Alternativa
# round(cov(datos[-1]), 1)
```

D. Podría decir cuál y cuáles variables son las más dispersas ?

```{r}
sapply(datos[-1], function(x) mean(x) / sd(x)) %>%
    sort()
```
Calculamos el coeficiente de variacion y vemos que las variables con mayor
dispersion son, en orden decreciente, LONANCHO, LONGPET y PECLIMBO.

E. Estandarice las variables por media y desvío. Ahora puede responder al 
inciso (d) ?

```{r}
# No utilizamos la primer columna
datos_std = scale(datos[-1])
```

Como son variables estandarizadas, vamos a ver que todos tienen coeficiente de
variacion igual a 0, que es un reflejo de que tienen media 0.

```{r}
sapply(as.data.frame(datos_std), function(x) mean(x) / sd(x)) %>%
    sort()
```

F. Halle la matriz de correlación. Que variables son las más relacionadas?

```{r}
cor(datos[-1]) 
```


A continuacion una tabla con las correlaciones entre variables, ordenadas de 
mayor a menor magnitud.

```{r}
datos_corr = cor(datos[-1]) %>%
    as.table() %>% 
    as.data.frame() %>% 
    rename(
        var1 = Var1,
        var2 = Var2,
        corr = Freq
    ) %>% 
    unique() %>%
    filter(var1 != var2) %>%
    arrange(desc(abs(corr)))
datos_corr %>%
    filter(abs(corr) > 0.7)
```

G. Pueden dividirse las variables en subgrupos, de modo que las variables dentro de un mismo subgrupo
tengan elevadas correlaciones entre sí y que las que se encuentren en subgrupos diferentes tengan bajas
correlaciones ? Si es así, cuáles variables quedan en cada uno de los subgrupos ?

H. Encuentre la matriz que mide el grado de similaridad entre las variedades en función de la distancia
euclídea calculada sobre los datos originales.

I. Podría decir cuales son los tres pares de variedades que presentan mayor semejanza ?

J. Repita lo realizado en el inciso (h) pero sobre las variables estandarizadas por media y desvío estándar.
Son las mimas las tres variedades más parecidas ? Comente al respecto